library(DoE.base)
x1<-1000
x3<-3000
x5<-5000
x7<-7000

y1<-c(1925, 1981, 2027, 2183, 2196, 2167, 2169, 2174, 
			2198, 2149, 2180, 2119, 1925, 1972, 2027, 2135, 
			2154, 2112, 2038, 2027, 2041, 1771, 1798, 1792, 
			2155, 2179, 2132, 1988, 1979, 2027, 1869, 1852, 
			1861, 2154, 2172, 2130, 1988, 1979, 2027, 2135, 
			2157, 2111, 1925, 1972, 2027, 2110, 2109, 2102, 
			1925, 1972, 2027, 1988, 1979, 1988)
y3<-c(3747, 3725, 3732, 3373, 3317, 3359, 4843, 4832,
			4845, 3524, 3512, 3562, 2611, 2628, 2617, 2807,
			2814, 2802, 4592, 4614, 4605, 2916, 2848, 2814, 
			3052, 3105, 3071, 2604, 2626, 2619, 2689, 2701, 
			2685, 3533, 3574, 3599, 3518, 3533, 3449, 2488, 
			2496, 2486, 2824, 2846, 2831, 5039, 5086, 5064, 
			2698, 2699, 2701, 2544, 2571, 2571)
y5<-c(5928, 6195, 5829, 5174, 5250, 5161, 7759, 7708, 
			7752, 5854, 5968, 5928, 3999, 3939, 3937, 4375, 
			4334, 4357, 7356, 7350, 7350, 4884, 4776, 4691, 
			4873, 4851, 4822, 3711, 3699, 3706, 4039, 4009, 
			4001, 5495, 5543, 5571, 5339, 5341, 5306, 3549, 
			3550, 3552, 4393, 4066, 4200, 8310, 8321, 8310, 
			3877, 3911, 3849, 3691, 3680, 3692)
y7<-c(8058, 8135, 8724, 7376, 7738, 7443, 10855, 10857, 
			10800, 8829, 9058, 8885, 5643, 5539, 5600, 5968, 
			5933, 5924, 10228, 10184, 10167, 6953, 6841, 6976, 
			8198, 8141, 7724, 5062, 5083, 5120, 5324, 5320, 
			5258, 7897, 8064, 7888, 7178, 7105, 7150, 4878, 
			4902, 4914, 6375, 6426, 6396, 11611, 11637, 11609, 
			5592, 5379, 5600, 5042, 5027, 5021)
g1<-0
g2<-1


data1<-data.frame(g=g1,rbind(merge(x1,y1),merge(x3,y3)))
data2<-data.frame(g=g2,rbind(merge(x3,y3),merge(x5,y5)))
data<-data.frame(rbind(data1,data2))

# 並行性の検定 ***があれば違う傾き
summary.aov(lm(y~x*factor(g), data=data))


data1<-data.frame(g=g1,rbind(merge(x3,y3),merge(x5,y5)))
data2<-data.frame(g=g2,rbind(merge(x5,y5),merge(x7,y7)))
data<-data.frame(rbind(data1,data2))

# 並行性の検定 ***があれば違う傾き
summary.aov(lm(y~x*factor(g), data=data))

q()

#              Df    Sum Sq   Mean Sq F value Pr(>F)    
# x             1 257712187 257712187 312.063 <2e-16 ***
# factor(g)     1         0         0   0.000 1.0000    
# x:factor(g)   1   4365654   4365654   5.286 0.0225 *  
# Residuals   212 175076518    825833                   

#              Df    Sum Sq   Mean Sq F value Pr(>F)    
# x             1 429180615 429180615 194.423 <2e-16 ***
# factor(g)     1         0         0   0.000  1.000    
# x:factor(g)   1   1459280   1459280   0.661  0.417    
# Residuals   212 467981318   2207459                   
# ---
# Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


x1<-0.1
y1<-c(0.21,0.22,0.2,0.19,0.18)
x2<-0.2
y2<-c(0.41,0.42,0.4,0.39,0.38)
x3<-0.3
y3<-c(0.81,0.82,0.8,0.79,0.78)

g1<-0
g2<-1

data1<-data.frame(g=g1,rbind(merge(x1,y1),merge(x2,y2)))
data2<-data.frame(g=g2,rbind(merge(x2,y2),merge(x3,y3)))
data<-data.frame(rbind(data1,data2))
# data2<-data.frame(data2)<-rbind(data1,data2)
print(data)
#http://anchoret.seesaa.net/article/118194434.html
# summary.aov(lm(Fruit~Root*Grazing))
summary.aov(lm(y~x*factor(g), data=data))
q()


cw<-read.csv("out_result.csv")

y1<-c(7759,3549,3877,4039,5495,3711,3999,4375,8310,5854,
			3691,5339,4884,4393,5174,5928,4873,7356)
y2<-c(7708,3550,3911,4009,5543,3699,3939,4334,8321,5968,
			3680,5341,4776,4066,5250,6195,4851,7350)
y3<-c(7752,3552,3849,4001,5571,3706,3937,4357,8310,5928,
			3692,5306,4691,4200,5161,5829,4822,7350)
r<-data.frame(y1,y2,y3)
y<-0

d<-data.frame(z1=cw[1], z2=cw[2], z3=cw[3], z4=cw[4], z5=cw[5],
							z6=cw[6], o5=cw[7], y=r) #[[1]][[1]])
							#cw[[16]][[1]])
#aov(z1=cw[1], z2=cw[2], z3=cw[3], z4=cw[4], z5=cw[5], z6=cw[6], o5=cw[7], y=cw[8] 

print(d)
ans<-aov(y1+y2+y3~z1+z2+z3+z4+z5+z6+o5, d=d)
# print(ans)
ans2<-anova(ans)
print(ans2)
summary(ans2)

quit()
A<-paste("A",c(1,1,1,1,2,2,2,2),sep="")
B<-paste("A",c(1,1,2,2,2,2,1,1),sep="")
C<-paste("A",c(1,2,1,2,2,1,2,1),sep="")
D<-paste("A",c(1,2,2,1,2,1,1,2),sep="")
v1<-c(40,46,28,18,32,26,32,58)
v2<-c(42,44,31,17,35,25,31,62)
V<-data.frame(v1,v2)

data<-data.frame(A=A,B=B,C=C,D=D,V=V)
result<-summary(aov(v1+v2~A+B+C+D,data=data))
print(result)
quit()
# for (i in 8:22) {
# 	print(names(cw[i]))
# 	d<-data.frame(z1=cw[1], z2=cw[2], z3=cw[3], z4=cw[4], 
# 								z5=cw[5], z6=cw[6], o5=cw[7], y=cw[[i]][[1]])
# 	ans<-aov(d$y~d$z1+d$z2+d$z3+d$z4+d$z5+d$z6+d$o5)
# 	ans2<-anova(ans)
# 	print(ans2)
# }

# # 1:7=z1~o5, 8:70,500,
# 5000
# [0, 0, 0, 0, 0, 0, 0]=>[7759, 7708, 7752],
# [0, 0, 1, 1, 2, 2, 1]=>[3549, 3550, 3552],
# [0, 1, 0, 2, 2, 1, 2]=>[3877, 3911, 3849],
# [0, 1, 2, 0, 1, 2, 0]=>[4039, 4009, 4001],
# [0, 2, 1, 2, 1, 0, 1]=>[5495, 5543, 5571],
# [0, 2, 2, 1, 0, 1, 2]=>[3711, 3699, 3706],
# [1, 0, 0, 2, 1, 2, 2]=>[3999, 3939, 3937],
# [1, 0, 2, 0, 2, 1, 1]=>[4375, 4334, 4357],
# [1, 1, 1, 1, 1, 1, 0]=>[8310, 8321, 8310],
# [1, 1, 2, 2, 0, 0, 1]=>[5854, 5968, 5928],
# [1, 2, 0, 1, 2, 0, 0]=>[3691, 3680, 3692],
# [1, 2, 1, 0, 0, 2, 2]=>[5339, 5341, 5306],
# [2, 0, 1, 2, 0, 1, 0]=>[4884, 4776, 4691],
# [2, 0, 2, 1, 1, 0, 2]=>[4393, 4066, 4200],
# [2, 1, 0, 1, 0, 2, 1]=>[5174, 5250, 5161],
# [2, 1, 1, 0, 2, 0, 2]=>[5928, 6195, 5829],
# [2, 2, 0, 0, 1, 1, 1]=>[4873, 4851, 4822],
# [2, 2, 2, 2, 2, 2, 0]=>[7356, 7350, 7350]